<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wilde Liga Bremen - Fu√üball</title>
    <link rel="stylesheet" href="styles/wilde-liga.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Supabase Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <h1>‚öΩ Wilde Liga Bremen</h1>
                <p>Deine lokale Fu√üballliga</p>
            </div>
            <nav class="nav">
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#tabelle">Tabelle</a></li>
                    <li><a href="#ergebnisse">Ergebnisse</a></li>
                    <li><a href="#termine">Termine</a></li>
                    <li><a href="pokal.html" class="pokal-link">Pokal</a></li>
                    <li><a href="#teams">Teams</a></li>
                    <li><a href="login.html" class="login-link">Login</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Hero Section -->
            <section class="hero" id="home">
                <h2>Willkommen zur Wilde Liga Bremen</h2>
                <p>Die spannendste Fu√üballliga in Bremen - Spieltag f√ºr Spieltag pure Leidenschaft!</p>
            </section>

            <!-- League Table -->
            <section class="league-table-section" id="tabelle">
                <div class="section-header">
                    <h2>Tabelle</h2>
                    <div class="season-selector">
                        <label for="season-select">Saison:</label>
                        <select id="season-select">
                            <option value="">Wird geladen...</option>
                        </select>
                    </div>
                </div>
                <div class="table-container">
                    <table class="league-table">
                        <thead>
                            <tr>
                                <th>Platz</th>
                                <th>Team</th>
                                <th>Sp</th>
                                <th>S</th>
                                <th>U</th>
                                <th>N</th>
                                <th>Tore</th>
                                <th>Diff</th>
                                <th>Punkte</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="champion">
                                <td>1</td>
                                <td class="team-name">FC Werdersee</td>
                                <td>12</td>
                                <td>10</td>
                                <td>1</td>
                                <td>1</td>
                                <td>32:8</td>
                                <td>+24</td>
                                <td class="points">31</td>
                            </tr>
                            <tr class="champion">
                                <td>2</td>
                                <td class="team-name">SV Neustadt</td>
                                <td>12</td>
                                <td>8</td>
                                <td>2</td>
                                <td>2</td>
                                <td>28:15</td>
                                <td>+13</td>
                                <td class="points">26</td>
                            </tr>
                            <tr class="champion">
                                <td>3</td>
                                <td class="team-name">Bremer SV</td>
                                <td>12</td>
                                <td>7</td>
                                <td>3</td>
                                <td>2</td>
                                <td>25:18</td>
                                <td>+7</td>
                                <td class="points">24</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td class="team-name">FC Vahr</td>
                                <td>12</td>
                                <td>6</td>
                                <td>2</td>
                                <td>4</td>
                                <td>21:19</td>
                                <td>+2</td>
                                <td class="points">20</td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td class="team-name">TSV Findorff</td>
                                <td>12</td>
                                <td>5</td>
                                <td>3</td>
                                <td>4</td>
                                <td>18:20</td>
                                <td>-2</td>
                                <td class="points">18</td>
                            </tr>
                            <tr>
                                <td>6</td>
                                <td class="team-name">SG Aumund</td>
                                <td>12</td>
                                <td>4</td>
                                <td>4</td>
                                <td>4</td>
                                <td>16:17</td>
                                <td>-1</td>
                                <td class="points">16</td>
                            </tr>
                            <tr>
                                <td>7</td>
                                <td class="team-name">FC Borgfeld</td>
                                <td>12</td>
                                <td>3</td>
                                <td>3</td>
                                <td>6</td>
                                <td>14:22</td>
                                <td>-8</td>
                                <td class="points">12</td>
                            </tr>
                            <tr class="relegation">
                                <td>8</td>
                                <td class="team-name">SV Grohn</td>
                                <td>12</td>
                                <td>2</td>
                                <td>4</td>
                                <td>6</td>
                                <td>12:24</td>
                                <td>-12</td>
                                <td class="points">10</td>
                            </tr>
                            <tr class="relegation">
                                <td>9</td>
                                <td class="team-name">FC Schwachhausen</td>
                                <td>12</td>
                                <td>1</td>
                                <td>3</td>
                                <td>8</td>
                                <td>9:26</td>
                                <td>-17</td>
                                <td class="points">6</td>
                            </tr>
                            <tr class="relegation">
                                <td>10</td>
                                <td class="team-name">TSV Lesum</td>
                                <td>12</td>
                                <td>0</td>
                                <td>3</td>
                                <td>9</td>
                                <td>8:30</td>
                                <td>-22</td>
                                <td class="points">3</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="table-legend">
                    <span class="legend-item champion">üèÜ Champions League Pl√§tze</span>
                    <span class="legend-item relegation">‚¨áÔ∏è Abstiegspl√§tze</span>
                </div>
            </section>

            <!-- Latest Results -->
            <section class="results-section" id="ergebnisse">
                <div class="section-header">
                    <h2>Spielergebnisse</h2>
                    <div class="season-selector">
                        <label for="results-season-select">Saison:</label>
                        <select id="results-season-select">
                            <option value="">Wird geladen...</option>
                        </select>
                    </div>
                </div>
                
                <!-- Filter Controls -->
                <div class="filter-controls">
                    <div class="filter-group">
                        <label for="matchday-select">Spieltag:</label>
                        <select id="matchday-select">
                            <option value="all">Alle Spieltage</option>
                            <option value="12" selected>12. Spieltag</option>
                            <option value="11">11. Spieltag</option>
                            <option value="10">10. Spieltag</option>
                            <option value="9">9. Spieltag</option>
                            <option value="8">8. Spieltag</option>
                            <option value="7">7. Spieltag</option>
                            <option value="6">6. Spieltag</option>
                            <option value="5">5. Spieltag</option>
                            <option value="4">4. Spieltag</option>
                            <option value="3">3. Spieltag</option>
                            <option value="2">2. Spieltag</option>
                            <option value="1">1. Spieltag</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="team-select">Team:</label>
                        <select id="team-select">
                            <option value="all">Alle Teams</option>
                            <option value="FC Werdersee">FC Werdersee</option>
                            <option value="SV Neustadt">SV Neustadt</option>
                            <option value="Bremer SV">Bremer SV</option>
                            <option value="FC Vahr">FC Vahr</option>
                            <option value="TSV Findorff">TSV Findorff</option>
                            <option value="SG Aumund">SG Aumund</option>
                            <option value="FC Borgfeld">FC Borgfeld</option>
                            <option value="SV Grohn">SV Grohn</option>
                            <option value="FC Schwachhausen">FC Schwachhausen</option>
                            <option value="TSV Lesum">TSV Lesum</option>
                        </select>
                    </div>
                </div>

                <div class="results-grid" id="results-container">
                    <!-- Matchday 12 -->
                    <div class="matchday" data-matchday="12">
                        <h3>12. Spieltag</h3>
                        <div class="matches">
                            <div class="match" data-home="FC Werdersee" data-away="SV Neustadt">
                                <span class="team home">FC Werdersee</span>
                                <span class="score">3:1</span>
                                <span class="team away">SV Neustadt</span>
                            </div>
                            <div class="match" data-home="Bremer SV" data-away="FC Vahr">
                                <span class="team home">Bremer SV</span>
                                <span class="score">2:0</span>
                                <span class="team away">FC Vahr</span>
                            </div>
                            <div class="match" data-home="TSV Findorff" data-away="SG Aumund">
                                <span class="team home">TSV Findorff</span>
                                <span class="score">1:1</span>
                                <span class="team away">SG Aumund</span>
                            </div>
                            <div class="match" data-home="FC Borgfeld" data-away="SV Grohn">
                                <span class="team home">FC Borgfeld</span>
                                <span class="score">0:2</span>
                                <span class="team away">SV Grohn</span>
                            </div>
                            <div class="match" data-home="FC Schwachhausen" data-away="TSV Lesum">
                                <span class="team home">FC Schwachhausen</span>
                                <span class="score">1:4</span>
                                <span class="team away">TSV Lesum</span>
                            </div>
                        </div>
                    </div>

                    <!-- Matchday 11 -->
                    <div class="matchday" data-matchday="11">
                        <h3>11. Spieltag</h3>
                        <div class="matches">
                            <div class="match" data-home="SV Neustadt" data-away="Bremer SV">
                                <span class="team home">SV Neustadt</span>
                                <span class="score">2:1</span>
                                <span class="team away">Bremer SV</span>
                            </div>
                            <div class="match" data-home="FC Vahr" data-away="TSV Findorff">
                                <span class="team home">FC Vahr</span>
                                <span class="score">3:2</span>
                                <span class="team away">TSV Findorff</span>
                            </div>
                            <div class="match" data-home="SG Aumund" data-away="FC Borgfeld">
                                <span class="team home">SG Aumund</span>
                                <span class="score">1:0</span>
                                <span class="team away">FC Borgfeld</span>
                            </div>
                            <div class="match" data-home="SV Grohn" data-away="FC Schwachhausen">
                                <span class="team home">SV Grohn</span>
                                <span class="score">2:2</span>
                                <span class="team away">FC Schwachhausen</span>
                            </div>
                            <div class="match" data-home="TSV Lesum" data-away="FC Werdersee">
                                <span class="team home">TSV Lesum</span>
                                <span class="score">0:3</span>
                                <span class="team away">FC Werdersee</span>
                            </div>
                        </div>
                    </div>

                    <!-- Matchday 10 -->
                    <div class="matchday" data-matchday="10" style="display: none;">
                        <h3>10. Spieltag</h3>
                        <div class="matches">
                            <div class="match" data-home="FC Werdersee" data-away="FC Borgfeld">
                                <span class="team home">FC Werdersee</span>
                                <span class="score">4:0</span>
                                <span class="team away">FC Borgfeld</span>
                            </div>
                            <div class="match" data-home="Bremer SV" data-away="SG Aumund">
                                <span class="team home">Bremer SV</span>
                                <span class="score">1:1</span>
                                <span class="team away">SG Aumund</span>
                            </div>
                            <div class="match" data-home="TSV Findorff" data-away="SV Grohn">
                                <span class="team home">TSV Findorff</span>
                                <span class="score">2:1</span>
                                <span class="team away">SV Grohn</span>
                            </div>
                            <div class="match" data-home="FC Schwachhausen" data-away="FC Vahr">
                                <span class="team home">FC Schwachhausen</span>
                                <span class="score">0:3</span>
                                <span class="team away">FC Vahr</span>
                            </div>
                            <div class="match" data-home="TSV Lesum" data-away="SV Neustadt">
                                <span class="team home">TSV Lesum</span>
                                <span class="score">1:2</span>
                                <span class="team away">SV Neustadt</span>
                            </div>
                        </div>
                    </div>

                    <!-- Matchday 9 -->
                    <div class="matchday" data-matchday="9" style="display: none;">
                        <h3>9. Spieltag</h3>
                        <div class="matches">
                            <div class="match" data-home="SV Neustadt" data-away="FC Schwachhausen">
                                <span class="team home">SV Neustadt</span>
                                <span class="score">3:0</span>
                                <span class="team away">FC Schwachhausen</span>
                            </div>
                            <div class="match" data-home="FC Vahr" data-away="TSV Lesum">
                                <span class="team home">FC Vahr</span>
                                <span class="score">2:1</span>
                                <span class="team away">TSV Lesum</span>
                            </div>
                            <div class="match" data-home="SV Grohn" data-away="FC Werdersee">
                                <span class="team home">SV Grohn</span>
                                <span class="score">0:2</span>
                                <span class="team away">FC Werdersee</span>
                            </div>
                            <div class="match" data-home="FC Borgfeld" data-away="TSV Findorff">
                                <span class="team home">FC Borgfeld</span>
                                <span class="score">1:1</span>
                                <span class="team away">TSV Findorff</span>
                            </div>
                            <div class="match" data-home="SG Aumund" data-away="Bremer SV">
                                <span class="team home">SG Aumund</span>
                                <span class="score">0:1</span>
                                <span class="team away">Bremer SV</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Termine Section -->
            <section class="tournaments-section" id="termine">
                <h2>Kommende Turniere & Events</h2>
                <div class="tournaments-grid">
                    <div class="tournament-card">
                        <div class="tournament-date">
                            <span class="month">Nov</span>
                            <span class="day">15</span>
                        </div>
                        <div class="tournament-info">
                            <h3>Herbstturnier 2024</h3>
                            <p class="tournament-location">üìç Sportpark Bremen-Nord</p>
                            <p class="tournament-details">Traditionelles Herbstturnier mit allen Liga-Teams</p>
                            <div class="tournament-tags">
                                <span class="tag">Alle Teams</span>
                                <span class="tag">Pokal</span>
                            </div>
                        </div>
                    </div>

                    <div class="tournament-card">
                        <div class="tournament-date">
                            <span class="month">Dez</span>
                            <span class="day">08</span>
                        </div>
                        <div class="tournament-info">
                            <h3>Weihnachtsturnier</h3>
                            <p class="tournament-location">üìç Halle Findorff</p>
                            <p class="tournament-details">Gem√ºtliches Hallenturnier vor Weihnachten</p>
                            <div class="tournament-tags">
                                <span class="tag">Halle</span>
                                <span class="tag">Fun</span>
                            </div>
                        </div>
                    </div>

                    <div class="tournament-card">
                        <div class="tournament-date">
                            <span class="month">Jan</span>
                            <span class="day">12</span>
                        </div>
                        <div class="tournament-info">
                            <h3>Neujahrs-Cup</h3>
                            <p class="tournament-location">üìç Weserstadion Bremen</p>
                            <p class="tournament-details">Gro√ües Turnier zum Saisonauftakt 2025</p>
                            <div class="tournament-tags">
                                <span class="tag">Highlight</span>
                                <span class="tag">Saisonstart</span>
                            </div>
                        </div>
                    </div>

                    <div class="tournament-card">
                        <div class="tournament-date">
                            <span class="month">Feb</span>
                            <span class="day">22</span>
                        </div>
                        <div class="tournament-info">
                            <h3>Junioren-F√∂rderturnier</h3>
                            <p class="tournament-location">üìç Sportplatz Vegesack</p>
                            <p class="tournament-details">Nachwuchsf√∂rderung f√ºr U16 und U18</p>
                            <div class="tournament-tags">
                                <span class="tag">Nachwuchs</span>
                                <span class="tag">F√∂rderung</span>
                            </div>
                        </div>
                    </div>

                    <div class="tournament-card">
                        <div class="tournament-date">
                            <span class="month">M√§r</span>
                            <span class="day">15</span>
                        </div>
                        <div class="tournament-info">
                            <h3>Fr√ºhjahrs-Masters</h3>
                            <p class="tournament-location">üìç Sportpark Werdersee</p>
                            <p class="tournament-details">Veteranen-Turnier f√ºr Spieler ab 35</p>
                            <div class="tournament-tags">
                                <span class="tag">Veteranen</span>
                                <span class="tag">Masters</span>
                            </div>
                        </div>
                    </div>

                    <div class="tournament-card">
                        <div class="tournament-date">
                            <span class="month">Apr</span>
                            <span class="day">26</span>
                        </div>
                        <div class="tournament-info">
                            <h3>Bremen-Cup Finale</h3>
                            <p class="tournament-location">üìç Weserstadion Bremen</p>
                            <p class="tournament-details">Gro√üe Saisonabschluss-Gala mit Preisverleihung</p>
                            <div class="tournament-tags">
                                <span class="tag">Finale</span>
                                <span class="tag">Gala</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Teams Section -->
            <section class="teams-section" id="teams">
                <h2>Unsere Teams</h2>
                <div class="teams-grid" id="teams-grid">
                    <!-- Teams werden dynamisch geladen -->
                    <div class="loading">
                        <p>Lade Teams...</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 Wilde Liga Bremen. Alle Rechte vorbehalten.</p>
        </div>
    </footer>

    <script>
        // Initialize page with dynamic data
        document.addEventListener('DOMContentLoaded', async function() {
            // Load seasons first and get current season
            const currentSeason = await loadSeasons();
            
            // Load dynamic data with current season
            if (currentSeason) {
                await loadStandings(currentSeason.id);
                await loadResults(currentSeason.id);
            } else {
                // Fallback to load without season filter
                await loadStandings();
                await loadResults();
            }
            
            await loadTeams();
            
            // Initialize filter functionality
            initializeFilters();
        });

        // Load seasons and populate selectors
        async function loadSeasons() {
            try {
                const seasons = await WildeLigaAPI.getSeasons();
                const currentSeason = await WildeLigaAPI.getCurrentSeason();
                
                console.log('Loaded seasons:', seasons);
                console.log('Current season:', currentSeason);
                
                const seasonSelect = document.getElementById('season-select');
                const resultsSeasonSelect = document.getElementById('results-season-select');
                
                console.log('Season select element:', seasonSelect);
                console.log('Results season select element:', resultsSeasonSelect);
                
                if (!seasonSelect || !resultsSeasonSelect) {
                    console.error('One or both dropdown elements not found!');
                    return null;
                }
                
                // Clear existing options
                seasonSelect.innerHTML = '';
                resultsSeasonSelect.innerHTML = '';
                
                // Add seasons to selectors
                seasons.forEach(season => {
                    const option1 = document.createElement('option');
                    option1.value = season.id;
                    option1.textContent = season.name;
                    if (season.status === 'active') {
                        option1.selected = true;
                    }
                    seasonSelect.appendChild(option1);
                    
                    const option2 = document.createElement('option');
                    option2.value = season.id;
                    option2.textContent = season.name;
                    if (season.status === 'active') {
                        option2.selected = true;
                    }
                    resultsSeasonSelect.appendChild(option2);
                });
                
                // Add event listeners for season changes with synchronization
                seasonSelect.addEventListener('change', function() {
                    const selectedSeasonId = this.value;
                    console.log('Season changed (standings):', selectedSeasonId);
                    
                    // Update both sections
                    loadStandings(selectedSeasonId);
                    loadResults(selectedSeasonId);
                    
                    // Synchronize the other dropdown
                    if (resultsSeasonSelect.value !== selectedSeasonId) {
                        resultsSeasonSelect.value = selectedSeasonId;
                    }
                });
                
                resultsSeasonSelect.addEventListener('change', function() {
                    const selectedSeasonId = this.value;
                    console.log('Season changed (results):', selectedSeasonId);
                    
                    // Update both sections
                    loadStandings(selectedSeasonId);
                    loadResults(selectedSeasonId);
                    
                    // Synchronize the other dropdown
                    if (seasonSelect.value !== selectedSeasonId) {
                        seasonSelect.value = selectedSeasonId;
                    }
                });
                
                console.log('Event listeners added successfully');
                
                // Return current season for initial load
                return currentSeason;
                
            } catch (error) {
                console.error('Error loading seasons:', error);
                return null;
            }
        }

        // Load standings from database
        async function loadStandings(seasonId = null) {
            try {
                const standings = await WildeLigaAPI.getStandings(seasonId);
                const tableBody = document.querySelector('.league-table tbody');
                
                if (standings && standings.length > 0) {
                    tableBody.innerHTML = '';
                    
                    standings.forEach((team, index) => {
                        const position = index + 1;
                        const isChampion = position <= 3;
                        const isRelegation = position >= 8;
                        
                        const row = `
                            <tr class="${isChampion ? 'champion' : ''} ${isRelegation ? 'relegation' : ''}">
                                <td>${position}</td>
                                <td class="team-name">${team.team_name}</td>
                                <td>${team.games_played}</td>
                                <td>${team.wins}</td>
                                <td>${team.draws}</td>
                                <td>${team.losses}</td>
                                <td>${team.goals_for}:${team.goals_against}</td>
                                <td>${team.goal_difference > 0 ? '+' : ''}${team.goal_difference}</td>
                                <td class="points">${team.points}</td>
                            </tr>
                        `;
                        tableBody.innerHTML += row;
                    });
                }
            } catch (error) {
                console.error('Error loading standings:', error);
            }
        }

        // Load results from database
        async function loadResults(seasonId = null) {
            try {
                console.log('Loading results for season:', seasonId);
                const matches = await WildeLigaAPI.getAllMatches(seasonId);
                console.log('Loaded matches:', matches);
                const resultsContainer = document.getElementById('results-container');
                
                if (matches && matches.length > 0) {
                    // Group matches by matchday
                    const matchesByMatchday = {};
                    const teamsInSeason = new Set();
                    
                    matches.forEach(match => {
                        if (!matchesByMatchday[match.matchday]) {
                            matchesByMatchday[match.matchday] = [];
                        }
                        matchesByMatchday[match.matchday].push(match);
                        
                        // Collect teams for team filter
                        teamsInSeason.add(match.home_team.name);
                        teamsInSeason.add(match.away_team.name);
                    });
                    
                    // Update matchday filter options
                    updateMatchdayFilter(Object.keys(matchesByMatchday));
                    
                    // Update team filter options
                    updateTeamFilter(Array.from(teamsInSeason));
                    
                    resultsContainer.innerHTML = '';
                    
                    // Create HTML for each matchday
                    Object.keys(matchesByMatchday)
                        .sort((a, b) => b - a) // Sort descending
                        .forEach(matchday => {
                            const matchdayHtml = `
                                <div class="matchday" data-matchday="${matchday}">
                                    <h3>${matchday}. Spieltag</h3>
                                    <div class="matches">
                                        ${matchesByMatchday[matchday].map(match => {
                                            const isScheduled = match.home_score === null || match.away_score === null;
                                            const scoreDisplay = isScheduled ? 'geplant' : `${match.home_score}:${match.away_score}`;
                                            return `
                                                <div class="match" data-home="${match.home_team.name}" data-away="${match.away_team.name}">
                                                    <span class="team home">${match.home_team.name}</span>
                                                    <span class="score ${isScheduled ? 'scheduled' : ''}">${scoreDisplay}</span>
                                                    <span class="team away">${match.away_team.name}</span>
                                                </div>
                                            `;
                                        }).join('')}
                                    </div>
                                </div>
                            `;
                            resultsContainer.innerHTML += matchdayHtml;
                        });
                        
                    // Re-initialize filters after content update
                    // Note: Don't call initializeFilters() here as it only handles matchday/team filters
                    // initializeFilters();
                }
            } catch (error) {
                console.error('Error loading results:', error);
            }
        }

        // Update matchday filter options
        function updateMatchdayFilter(matchdays) {
            const matchdaySelect = document.getElementById('matchday-select');
            const currentValue = matchdaySelect.value;
            
            matchdaySelect.innerHTML = '<option value="all">Alle Spieltage</option>';
            
            matchdays.sort((a, b) => b - a).forEach(matchday => {
                const option = document.createElement('option');
                option.value = matchday;
                option.textContent = `${matchday}. Spieltag`;
                matchdaySelect.appendChild(option);
            });
            
            // Try to maintain the current selection
            if (matchdays.includes(currentValue)) {
                matchdaySelect.value = currentValue;
            }
        }

        // Update team filter options
        function updateTeamFilter(teams) {
            const teamSelect = document.getElementById('team-select');
            const currentValue = teamSelect.value;
            
            teamSelect.innerHTML = '<option value="all">Alle Teams</option>';
            
            teams.sort().forEach(team => {
                const option = document.createElement('option');
                option.value = team;
                option.textContent = team;
                teamSelect.appendChild(option);
            });
            
            // Try to maintain the current selection
            if (teams.includes(currentValue)) {
                teamSelect.value = currentValue;
            }
        }

        // Load teams from database
        async function loadTeams() {
            try {
                const teams = await WildeLigaAPI.getTeamsWithStatus();
                const teamsGrid = document.getElementById('teams-grid');
                
                if (teams && teams.length > 0) {
                    teamsGrid.innerHTML = '';
                    
                    teams.forEach(team => {
                        const statusClass = team.isActive ? 'active' : 'inactive';
                        const statusIcon = team.isActive ? '‚úÖ' : '‚è∏Ô∏è';
                        
                        const teamHtml = `
                            <div class="team-card ${statusClass}">
                                <div class="team-logo">‚öΩ</div>
                                <h3>${team.name}</h3>
                                <p class="team-status">${statusIcon} ${team.status}</p>
                                <p class="team-description">${team.description || 'Traditioneller Verein aus Bremen'}</p>
                                <a href="teams/${team.name.toLowerCase().replace(/\s+/g, '-').replace('√§', 'ae').replace('√∂', 'oe').replace('√º', 'ue').replace('√ü', 'ss')}.html" class="team-link">Team kennenlernen</a>
                            </div>
                        `;
                        teamsGrid.innerHTML += teamHtml;
                    });
                } else {
                    teamsGrid.innerHTML = '<div class="no-teams">Keine Teams gefunden</div>';
                }
            } catch (error) {
                console.error('Error loading teams:', error);
                const teamsGrid = document.getElementById('teams-grid');
                teamsGrid.innerHTML = '<div class="error">Fehler beim Laden der Teams</div>';
            }
        }

        // Initialize filter functionality
        function initializeFilters() {
            const matchdaySelect = document.getElementById('matchday-select');
            const teamSelect = document.getElementById('team-select');
            const resultsContainer = document.getElementById('results-container');
            
            function filterResults() {
                const selectedMatchday = matchdaySelect.value;
                const selectedTeam = teamSelect.value;
                
                // Get all matchdays
                const matchdays = resultsContainer.querySelectorAll('.matchday');
                
                matchdays.forEach(matchday => {
                    const matchdayNumber = matchday.getAttribute('data-matchday');
                    let showMatchday = false;
                    
                    // Check if matchday should be shown
                    if (selectedMatchday === 'all' || selectedMatchday === matchdayNumber) {
                        if (selectedTeam === 'all') {
                            showMatchday = true;
                        } else {
                            // Check if selected team plays in this matchday
                            const matches = matchday.querySelectorAll('.match');
                            matches.forEach(match => {
                                const homeTeam = match.getAttribute('data-home');
                                const awayTeam = match.getAttribute('data-away');
                                
                                if (homeTeam === selectedTeam || awayTeam === selectedTeam) {
                                    showMatchday = true;
                                }
                            });
                        }
                    }
                    
                    // Show/hide matchday
                    matchday.style.display = showMatchday ? 'block' : 'none';
                    
                    // If team filter is active, highlight matches with the selected team
                    if (selectedTeam !== 'all' && showMatchday) {
                        const matches = matchday.querySelectorAll('.match');
                        matches.forEach(match => {
                            const homeTeam = match.getAttribute('data-home');
                            const awayTeam = match.getAttribute('data-away');
                            
                            if (homeTeam === selectedTeam || awayTeam === selectedTeam) {
                                match.style.display = 'grid';
                                match.style.backgroundColor = '#e8f5e8';
                                match.style.border = '2px solid var(--primary-color)';
                            } else {
                                match.style.display = 'none';
                            }
                        });
                    } else if (showMatchday) {
                        // Reset match styling when no team filter
                        const matches = matchday.querySelectorAll('.match');
                        matches.forEach(match => {
                            match.style.display = 'grid';
                            match.style.backgroundColor = '';
                            match.style.border = '';
                        });
                    }
                });
                
                // Update grid layout based on filter
                if (selectedMatchday !== 'all') {
                    resultsContainer.style.gridTemplateColumns = '1fr';
                } else {
                    resultsContainer.style.gridTemplateColumns = 'repeat(auto-fit, minmax(300px, 1fr))';
                }
            }
            
            // Remove existing event listeners to prevent duplicates
            matchdaySelect.removeEventListener('change', filterResults);
            teamSelect.removeEventListener('change', filterResults);
            
            // Add event listeners
            matchdaySelect.addEventListener('change', filterResults);
            teamSelect.addEventListener('change', filterResults);
            
            // Initial filter
            filterResults();
        }
    </script>
</body>
</html>
